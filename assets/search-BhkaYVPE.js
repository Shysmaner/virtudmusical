import{r as n,j as s,d as m,s as O,c as U,T as W,F as G,a as J}from"./TagsComponent-vu07Nl3u.js";import{c as b,q as h,w as l,g,l as K,o as V,a as X,H as Y,b as Z}from"./HeaderWithSearchComponent-DlSI16zO.js";import{C as _}from"./CookiesComponent-CpydfYC0.js";function ss(){const[x,F]=n.useState([]),[c,z]=n.useState([]),[u,P]=n.useState([]),[w,S]=n.useState([]),[p,$]=n.useState(null),[i,y]=n.useState(1),j=10,v=i*j,Q=v-j,E=c.slice(Q,v),C=Math.ceil(c.length/j),o=e=>e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""),I=async e=>{$(decodeURI(e));const a=o(decodeURI(e)),f=b(k,"songs"),L=b(k,"artists"),T=h(f,l("titleNormalized",">=",a),l("titleNormalized","<=",a+"")),q=h(f,l("artistNormalized",">=",a),l("artistNormalized","<=",a+"")),A=h(L,l("nameNormalized",">=",a),l("nameNormalized","<=",a+"")),[B,D,H]=await Promise.all([g(T),g(q),g(A)]);let r=B.docs.map(t=>({id:t.data().title,type:"song",...t.data()})),N=D.docs.map(t=>({id:t.data().title,type:"song",...t.data()})),d=H.docs.map(t=>({id:t.data().name,type:"artist",...t.data()}));if(r=r.filter(t=>o(t.title).includes(a)||t.artist&&o(t.artist).includes(a)),N=N.filter(t=>o(t.title).includes(a)||t.artist&&o(t.artist).includes(a)),d=d.filter(t=>o(t.name).includes(a)),r.length===0&&d.length===0){const t=h(f,V("views","desc"),K(5)),M=(await g(t)).docs.map(R=>({id:R.data().title,type:"song",...R.data()}));S(M)}else S([]);F(r),z(N),P(d)};return n.useEffect(()=>{I(window.location.href.split("?")[1])},[]),s.jsxs("div",{className:"content",children:[x.length>0&&s.jsx("h2",{children:"Songs found"}),x.length>0?x.map((e,a)=>s.jsxs("div",{className:"result-item",onClick:()=>window.location.href=`${m}/src/songs/${e.id}/index.html`,children:[s.jsxs("span",{className:"title",children:[e.id," by ",e.artist]}),s.jsxs("span",{className:"views",children:[e.views," ",s.jsx("i",{className:"fa-regular fa-eye"})]})]},a)):s.jsxs("p",{children:["No songs found named ",p]}),c.length>0&&s.jsxs("h2",{children:["Songs related to ",p]}),c.length>0?s.jsxs(s.Fragment,{children:[E.map((e,a)=>s.jsxs("div",{className:"result-item",onClick:()=>window.location.href=`${m}/src/songs/${e.id}/index.html`,children:[s.jsxs("span",{className:"title",children:[e.id," by ",e.artist]}),s.jsxs("span",{className:"views",children:[e.views," ",s.jsx("i",{className:"fa-regular fa-eye"})]})]},a)),s.jsxs("div",{className:"pagination",children:[s.jsx("button",{disabled:i===1,onClick:()=>y(i-1),children:"Previous"}),s.jsxs("span",{children:["Page ",i," of ",C]}),s.jsx("button",{disabled:i===C,onClick:()=>y(i+1),children:"Next"})]})]}):s.jsxs("p",{children:["No songs related to ",p," found"]}),u.length>0&&s.jsx("h2",{children:"Artists found"}),u.length>0?u.map((e,a)=>s.jsxs("div",{className:"result-item",onClick:()=>window.location.href=`${m}/src/artists/${e.id}/index.html`,children:[s.jsx("span",{className:"title",children:e.id}),s.jsxs("span",{className:"views",children:[e.views," ",s.jsx("i",{className:"fa-regular fa-eye"})]})]},a)):s.jsx("p",{children:"No artists found"}),w.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("h2",{children:"Recommended"}),w.map((e,a)=>s.jsxs("div",{className:"result-item",onClick:()=>window.location.href=`${m}/src/songs/${e.id}/index.html`,children:[s.jsxs("span",{className:"title",children:[e.id," by ",e.artist]}),s.jsxs("span",{className:"views",children:[e.views," ",s.jsx("i",{className:"fa-regular fa-eye"})]})]},a))]})]})}const k=X(Z);O();U(document.getElementById("root")).render(s.jsxs(n.StrictMode,{children:[s.jsx(W,{}),s.jsx(Y,{}),s.jsx(ss,{}),s.jsx(G,{}),s.jsx(J,{}),s.jsx(_,{})]}));
