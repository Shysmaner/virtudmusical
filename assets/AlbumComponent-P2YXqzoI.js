var p=Object.defineProperty;var g=(i,o,e)=>o in i?p(i,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[o]=e;var l=(i,o,e)=>g(i,typeof o!="symbol"?o+"":o,e);import{R as x,j as s,d as c}from"./TagsComponent-B2N3reKh.js";import{q as d,c as h,w as j,l as b,g as u}from"./HeaderWithSearchComponent-xTrOAoUr.js";import{d as f}from"./main-Cb0_GsMS.js";import{b as N}from"./ViewsIncrement-BSjlBeua.js";import{B as S}from"./Content-hktX8tII.js";class R extends x.Component{constructor(e){super(e);l(this,"fetchAlbumInfo",async e=>{try{const t=d(h(f,"albums"),j("name","==",e),b(1)),r=await u(t);if(r.empty)this.setState({error:`Album not found: ${e}`});else{const n=r.docs[0].data(),a=r.docs[0].ref,m=h(a,"songs");this.setState({album:{...n,docRef:a},error:null}),this.fetchSongs(m)}}catch(t){console.error("Error fetching album: ",t),this.setState({error:"Error fetching album data."})}});l(this,"fetchSongs",async e=>{try{const t=await u(e);if(t.empty)this.setState({error:"No songs found for this album."});else{const r=t.docs.map(n=>({title:n.data().title,artist:n.data().artist,id:n.id}));this.setState({songs:r})}}catch(t){console.error("Error fetching songs: ",t),this.setState({error:"Error fetching songs."})}});l(this,"incrementView",async()=>{const{album:e}=this.state;if(e&&e.docRef)try{await N(e.docRef),this.setState({hasIncrementedView:!0})}catch(t){console.error("Error incrementing view: ",t)}});l(this,"fetchMoreAlbums",async()=>{try{const e=d(h(f,"albums"),b(10)),t=await u(e);if(!t.empty){const r=t.docs.map(n=>({albumName:n.data().name,albumImageUrl:n.data().imageUrl}));this.setState({moreAlbums:r})}}catch(e){console.error("Error fetching more albums: ",e)}});this.state={album:null,songs:[],error:null,hasIncrementedView:!1,moreAlbums:[],albumName:null}}componentDidMount(){this.fetchAlbumInfo(this.props.albumName),this.setState({albumName:this.props.albumName}),this.fetchMoreAlbums()}componentDidUpdate(e,t){this.state.album&&!this.state.hasIncrementedView&&(this.incrementView(),this.setState({hasIncrementedView:!0}))}render(){const{album:e,songs:t,error:r,moreAlbums:n}=this.state;return s.jsxs("div",{className:"album-component",children:[r&&s.jsx("p",{className:"error",children:r}),e?s.jsxs("div",{children:[s.jsx("h1",{children:e.name}),s.jsxs("p",{children:[s.jsx("i",{className:"fa-regular fa-eye"}),e.views]}),s.jsx("img",{src:e.imageUrl,alt:e.name}),s.jsxs("h2",{alt:`Songs in the album ${e.name}`,children:["Songs in the album ",e.name]}),t.length>0?s.jsx("ul",{children:t.map((a,m)=>s.jsx("li",{children:s.jsxs("a",{href:`${c}/src/songs/${a.id}/index.html`,className:"song-a",children:[s.jsx("p",{className:"artist-name",children:a.id}),s.jsx("span",{children:a.artist})]})},m))}):s.jsx("p",{children:"No songs found for this album."}),s.jsxs("div",{className:"more-albums-div",children:[s.jsx("h3",{alt:"Albums you might be interested in on VirtudMusical",children:"ALBUMS YOU MIGHT BE INTERESTED IN"}),n.map((a,m)=>this.state.albumName!==a.albumName&&s.jsxs("div",{className:"album-card",children:[s.jsx("img",{src:a.albumImageUrl,alt:a.albumName,onClick:()=>window.location.href=`${c}/src/albums/${a.albumName}/index.html`}),s.jsx("div",{className:"album-info",children:s.jsx("a",{href:`${c}/src/albums/${a.albumName}/index.html`,children:a.albumName})})]},m))]})]}):s.jsx("p",{children:"Loading album information..."}),s.jsx(S,{})]})}}export{R as G};
