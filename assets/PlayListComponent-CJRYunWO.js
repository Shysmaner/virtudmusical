var x=Object.defineProperty;var g=(n,i,s)=>i in n?x(n,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[i]=s;var o=(n,i,s)=>g(n,typeof i!="symbol"?i+"":i,s);import{R as j,j as t,d as m}from"./TagsComponent-B2N3reKh.js";import{q as d,c as h,w as N,l as y,g as p}from"./HeaderWithSearchComponent-xTrOAoUr.js";import{d as f}from"./main-Cb0_GsMS.js";import{c as u}from"./ViewsIncrement-BSjlBeua.js";import{B as S}from"./Content-hktX8tII.js";class V extends j.Component{constructor(s){super(s);o(this,"fetchPlaylistInfo",async s=>{try{const e=d(h(f,"playlists"),N("name","==",s),y(1)),r=await p(e);if(r.empty)this.setState({error:`No se encontró la playlist: ${s}`});else{const l=r.docs[0].data(),a=r.docs[0].ref,c=h(a,"songs");this.setState({playlist:{...l,docRef:a},error:null}),this.fetchSongs(c)}}catch(e){console.error("Error al obtener la playlist: ",e),this.setState({error:"Error al obtener los datos de la playlist."})}});o(this,"fetchSongs",async s=>{try{const e=await p(s);if(e.empty)this.setState({error:"No se encontraron canciones para esta playlist."});else{const r=e.docs.map(l=>({id:l.id,title:l.data().title,artist:l.data().artist}));this.setState({songs:r})}}catch(e){console.error("Error al obtener las canciones: ",e),this.setState({error:"Error al obtener las canciones."})}});o(this,"fetchMorePlaylists",async()=>{try{const s=d(h(f,"playlists"),y(10)),e=await p(s);if(!e.empty){const r=e.docs.map(l=>({playlistName:l.data().name,playlistImageUrl:l.data().imageUrl}));this.setState({morePlaylists:r})}}catch(s){console.error("Error al obtener más playlists: ",s)}});o(this,"incrementView",async()=>{const{playlist:s}=this.state;if(s&&s.docRef)try{await u(s.docRef),this.setState({hasIncrementedView:!0})}catch(e){console.error("Error incrementando la vista: ",e)}});this.state={playlist:null,songs:[],error:null,hasIncrementedView:!1,morePlaylists:[],playlistName:null}}componentDidMount(){this.fetchPlaylistInfo(this.props.playlistName),this.setState({playlistName:this.props.playlistName}),this.fetchMorePlaylists()}componentDidUpdate(s,e){this.state.playlist&&!this.state.hasIncrementedView&&(this.incrementView(),this.setState({hasIncrementedView:!0}))}render(){const{playlist:s,songs:e,error:r,morePlaylists:l}=this.state;return t.jsxs("div",{className:"song-component",children:[r&&t.jsx("p",{className:"error",children:r}),s?t.jsxs("div",{children:[t.jsx("h1",{children:s.name}),t.jsxs("p",{children:[t.jsx("i",{className:"fa-regular fa-eye"}),s.views]}),t.jsx("img",{src:s.imageUrl,alt:s.name}),t.jsxs("h2",{alt:`Songs in the playlist ${s.name}`,children:["Songs in the playlist ",s.name]}),e.length>0?t.jsx("ul",{children:e.map((a,c)=>t.jsx("li",{children:t.jsxs("a",{href:`${m}/src/songs/${a.id}/index.html`,className:"song-a",children:[t.jsx("p",{className:"artist-name",children:a.id||"Untitled"}),t.jsx("span",{children:a.artist})]})},a.id))}):t.jsx("p",{children:"No songs found for this playlist."}),t.jsxs("div",{className:"more-playlists-div",children:[t.jsx("h3",{alt:"Playlists you might be interested in on VirtudMusical",children:"PLAYLISTS YOU MIGHT BE INTERESTED IN"}),l.map((a,c)=>this.state.playlistName!==a.playlistName&&t.jsxs("div",{className:"playlist-card",children:[t.jsx("img",{src:a.playlistImageUrl,alt:a.playlistName,onClick:()=>window.location.href=`${m}/src/playlists/${a.playlistName}/index.html`}),t.jsx("div",{className:"playlist-info",children:t.jsx("a",{href:`${m}/src/playlists/${a.playlistName}/index.html`,children:a.playlistName})})]},c))]})]}):t.jsx("p",{children:"Loading playlist information..."}),t.jsx(S,{})]})}}export{V as G};
