var h=Object.defineProperty;var l=(i,r,t)=>r in i?h(i,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[r]=t;var o=(i,r,t)=>l(i,typeof r!="symbol"?r+"":r,t);import{R as d,j as e,d as m}from"./TagsComponent-B2N3reKh.js";import{q as p,c as f,w as g,l as u,g as x}from"./HeaderWithSearchComponent-xTrOAoUr.js";import{d as j}from"./main-Cb0_GsMS.js";import{f as w}from"./fetchSongs-Dp-5TSDH.js";import{V as S}from"./ViewsIncrement-BSjlBeua.js";import{B as y}from"./Content-hktX8tII.js";class C extends d.Component{constructor(t){super(t);o(this,"fetchArtistInfo",async t=>{try{const s=p(f(j,"artists"),g("name","==",t),u(1)),n=await x(s);if(n.empty)this.setState({error:`Artist not found: ${t}`});else{const a=n.docs[0].data(),c=n.docs[0].ref;this.setState({artist:{...a,docRef:c},error:null}),w(t,this.updateSongs,this.updateError)}}catch(s){console.error("Error fetching artist: ",s),this.setState({error:"Error fetching artist data."})}});o(this,"incrementView",async()=>{const{artist:t}=this.state;if(t&&t.docRef)try{await S(t.docRef),this.setState({hasIncrementedView:!0})}catch(s){console.error("Error incrementing view: ",s)}});o(this,"updateSongs",t=>{this.setState({songs:t})});o(this,"updateError",t=>{this.setState({error:t})});o(this,"formatTitle",t=>t.replace(/\s*TraducciÃ³n-Translation\s*/gi," [English/Spanish] ").trim());this.state={artist:null,songs:[],error:null,hasIncrementedView:!1}}componentDidMount(){this.fetchArtistInfo(this.props.artistName)}componentDidUpdate(t,s){this.state.artist&&!this.state.hasIncrementedView&&(this.incrementView(),this.setState({hasIncrementedView:!0}))}render(){const{artist:t,songs:s,error:n}=this.state;return e.jsxs("div",{className:"song-component",children:[n&&e.jsx("p",{children:n}),t?e.jsxs("div",{children:[e.jsx("h1",{children:t.name}),e.jsxs("p",{children:[e.jsx("i",{className:"fa-regular fa-eye"}),t.views]}),e.jsx("img",{src:t.imageUrl,alt:t.name}),e.jsxs("h2",{children:["Songs by ",t.name]}),s.length>0?e.jsx("ul",{children:s.map((a,c)=>e.jsx("li",{onClick:()=>window.location.href=`${m}/src/songs/${a.title}/index.html`,children:this.formatTitle(a.title)},c))}):e.jsx("p",{children:"No songs found for this artist."})]}):e.jsx("p",{children:"Loading artist information..."}),e.jsx(y,{})]})}}export{C as G};
